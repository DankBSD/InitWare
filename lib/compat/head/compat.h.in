#ifndef COMPAT_H_IN_
#define COMPAT_H_IN_

#cmakedefine Sys_Plat_Linux
#cmakedefine Sys_Plat_BSD
#cmakedefine Sys_Plat_FreeBSD
#cmakedefine Sys_Plat_NetBSD
#cmakedefine Sys_Plat_DragonFlyBSD
#cmakedefine Sys_Plat_OpenBSD
#cmakedefine Sys_Plat_HPUX

#include <errno.h>
#include <sys/types.h>

/*
 * include files
 */
#cmakedefine Have_asm_types_h
#cmakedefine Have_linux_netlink_h
#cmakedefine Have_linux_sched_h
#cmakedefine Have_sys_endian_h
#cmakedefine Have_sys_procctl_h
#cmakedefine Have_sys_prctl_h
#cmakedefine Have_sys_statfs_h
#cmakedefine Have_sys_statvfs_h
#cmakedefine Have_sys_sysmacros_h
#cmakedefine Have_sys_ucred_h
#cmakedefine Have_sys_vfs_h
#cmakedefine Have_alloca_h
#cmakedefine Have_byteswap_h
#cmakedefine Have_endian_h
#cmakedefine Have_malloc_h
#cmakedefine Have_mntent_h
#cmakedefine Have_mqueue_h
#cmakedefine Have_printf_h

/*
 * functions
 */
#cmakedefine Have_environ
#cmakedefine Have_waitid
#cmakedefine Have_get_current_dir_name
#cmakedefine Have_mempcpy
#cmakedefine Have_parse_printf_format
#cmakedefine Have_posix_fallocate
#cmakedefine Have_program_invocation_short_name
#cmakedefine Have___secure_getenv
#cmakedefine Have_secure_getenv

/*
 * types
 */
#cmakedefine Have___compar_fn_t
#cmakedefine Have_socket_struct_ucred
#cmakedefine Have_statfs
#cmakedefine Have_statvfs
#cmakedefine Have_struct_cmsgcred

/*
 * compatibility Use-flags
 */
#cmakedefine Use_SystemdDBus
#cmakedefine Use_SystemdCompat

/*
 * feature Use-flags
 */
#cmakedefine Use_CGroups
#cmakedefine Use_KQProc
#cmakedefine Use_Libcap
#cmakedefine Use_MQueue
#cmakedefine Use_Libudev
#cmakedefine Use_Libdevattr


#define PACKAGE_NAME "@PACKAGE_NAME@"
#define PACKAGE_VERSION "@PACKAGE_VERSION@"
#define PACKAGE_STRING "@PACKAGE_STRING@"

#define DISTRIBUTION "@DISTRIBUTION@"

/*
 * Paths
 */
#define AbsDir_PkgRunState "@AbsDir_PkgRunState@"
#define AbsDir_PkgSysConf "@AbsDir_PkgSysConf@"
#define AbsDir_RunState "@AbsDir_RunState@"
#define AbsDir_User_RunStateBase "@AbsDir_User_RunStateBase@"
#define AbsDir_PkgLib "@AbsDir_PkgLib@"
#define AbsDir_PkgVarLib "@AbsDir_InitWareStateDir@"

#define PkgDirName "@PkgDirName@"

#define SYSTEM_CONFIG_FILE "@SYSTEM_CONFIG_FILE@"
#define SYSTEM_CONFIG_UNIT_PATH "@SYSTEM_CONFIG_UNIT_PATH@"
#define SYSTEM_DATA_UNIT_PATH "@SYSTEM_DATA_UNIT_PATH@"
#define SYSTEM_GENERATOR_PATH "@SYSTEM_GENERATOR_PATH@"

#define USER_CONFIG_FILE "@USER_CONFIG_FILE@"
#define USER_CONFIG_UNIT_PATH "@USER_CONFIG_UNIT_PATH@"
#define USER_DATA_UNIT_PATH "@USER_DATA_UNIT_PATH@"
#define USER_GENERATOR_PATH "@USER_GENERATOR_PATH@"

#define SYSTEMD_BINARY_PATH "@SYSTEMD_BINARY_PATH@"
#define SYSTEMD_CGROUP_AGENT_PATH "@SYSTEMD_CGROUP_AGENT_PATH"
#define SYSTEMD_SHUTDOWN_BINARY_PATH "@SYSTEMD_SHUTDOWN_BINARY_PATH@"
#define SYSTEMD_TTY_ASK_PASSWORD_AGENT_BINARY_PATH "@SYSTEMD_TTY_ASK_PASSWORD_AGENT_BINARY_PATH@"
#define SYSTEMD_STDIO_BRIDGE_BINARY_PATH "@SYSTEMD_STDIO_BRIDGE_BINARY_PATH@"

/*
 * File paths
 */
#define AbsPath_CatalogDatabase "@AbsPath_CatalogDatabase@"

/*
 * Binary paths
 */
#cmakedefine BinPath_Runrcng "@BinPath_Runrcng@"

#define POLKIT_AGENT_BINARY_PATH "@POLKIT_AGENT_BINARY_PATH@"

#ifdef Use_KQProc
#        define Use_PTGroups true
#endif

#if defined(Use_Libudev) | defined(Use_Libdevattr)
#        define Use_udev true
#endif

#ifdef Sys_Plat_FreeBSD
#        define _PATH_UTMPX "/var/run/utx.active"
#endif

#ifndef Have___compar_fn_t
        typedef int (*__compar_fn_t)(const void *, const void *);
#endif

#ifndef Have_environ
extern char **environ;
#endif

#ifndef Have_mempcpy
void *mempcpy(void *dest, const void *src, size_t n);
#endif

#ifndef Have_secure_getenv
#        define secure_getenv getenv
#endif

#ifndef Have_statfs
#        define statfs statvfs
#        define fstatfs fstatvfs
#endif

#ifndef Have_program_invocation_short_name
#        define program_invocation_short_name getprogname()
#endif

#ifndef Have_get_current_dir_name
#        define get_current_dir_name() getcwd(NULL, 0)
#endif

#ifndef EBADR
#        define EBADR EBADF
#endif

#ifndef ETIME
#        define ETIME ETIMEDOUT
#else
#        define Have_ETIME
#endif

#ifndef ENODATA
#        define ENODATA EBADF
#endif

#ifndef ENOKEY
#        define ENOKEY ENOENT
#endif

#ifdef Sys_Plat_Linux
#        define Use_Mount
#        define Use_Automount
#        define Use_Swap
#        define Use_Linprocfs
#endif

#ifdef Sys_Plat_Linux
#        define Dgram_Credpass_Linux
#elif defined(Sys_Plat_NetBSD)
#        define Dgram_Credpass_NetBSD
#elif defined(Sys_Plat_FreeBSD)
#        define Dgram_Credpass_FreeBSD
#else
#        define Dgram_Credpass_None
#endif

#ifndef strndupa
/*******************************************************************

        FOREIGN CODE BLOCK

    Origin: https://github.com/kraj/meta-musl/
    Licence: MIT
    Copyriight: Khem Raj

*********************************************************************/

#        define strndupa(s, n)                                    \
                ({                                                \
                        const char *__old = (s);                  \
                        size_t __len = strnlen(__old, (n));       \
                        char *__new = (char *) alloca(__len + 1); \
                        __new[__len] = '\0';                      \
                        (char *) memcpy(__new, __old, __len);     \
                })
#endif

#ifndef strdupa
#        define strdupa(s) strndupa(s, strlen(s))
#endif

#endif